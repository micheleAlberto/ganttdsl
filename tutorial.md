## **GanttDSL Tutorial: Writing and Scheduling Gantt Charts in Python**

This tutorial will guide you through using GanttDSL to manage, schedule, and visualize software engineering tasks in Python. GanttDSL allows you to write tasks in a literate programming style and output markdown or PlantUML Gantt charts.

---

### **1. Installation and Setup**

GanttDSL is implemented in Python. Clone or include the code from the implementation provided. For demonstration purposes, ensure all class definitions (`Task`, `Team`, `PlannedTask`, etc.) are available in your project.

---

### **2. Defining Tasks**

A `Task` in GanttDSL includes:
- A unique name
- A Markdown-formatted description
- References (e.g., links to documents)
- A point of contact
- An effort estimate in engineer-days
- A parallelization factor
- Dependencies on other tasks

#### Example: Defining Tasks

```python
from ganttdsl import Task

# Task 1: Prototype Design
task_a = Task(
    name="Prototype Design",
    description="Design the prototype with detailed requirements.",
    references=["https://example.com/design-doc"],
    point_of_contact="Engineer A",
    effort=10,  # Effort in engineer-days
    parallelization_factor=2  # Max engineers that can work on this
)

# Task 2: Build Prototype (depends on Task 1)
task_b = Task(
    name="Build Prototype",
    description="Build the prototype as per the design specifications.",
    references=["https://example.com/build-doc"],
    point_of_contact="Engineer B",
    effort=8,
    parallelization_factor=1,
    dependencies={task_a}
)
```

---

### **3. Defining a Team**

A `Team` specifies the name and number of engineers available.

#### Example: Creating a Team

```python
from ganttdsl import Team

team = Team(name="Engineering Team", size=3)
```

---

### **4. Scheduling Tasks**

To schedule tasks, use a subclass of `Scheduler`. The `CriticalPathScheduler` prioritizes tasks on the critical path, ensuring efficient project completion.

#### Key Steps:
1. Initialize the `CriticalPathScheduler`.
2. Specify a start date for the project.
3. Call the `schedule` method with tasks, the team, and the start date.

#### Example: Scheduling Tasks

```python
from ganttdsl import CriticalPathScheduler
from datetime import date

# Initialize scheduler and start date
scheduler = CriticalPathScheduler()
start_date = date(2025, 1, 1)

# Schedule tasks
plan = scheduler.schedule([task_a, task_b], team, start_date)
```

---

### **5. Viewing the Plan**

The `Plan` object generated by the scheduler provides multiple views:
1. **Markdown View**: A detailed breakdown of the tasks.
2. **Gantt Chart**: A PlantUML-compatible Gantt chart for visualization.

#### Example: Markdown View

```python
markdown = plan.get_markdown_view()
print(markdown)
```

**Output:**
```
### Prototype Design
**Description:** Design the prototype with detailed requirements.
**References:** https://example.com/design-doc
**Point of Contact:** Engineer A
**Effort:** 10 engineer-days
**Parallelization Factor:** 2
**Dependencies:** 
**Planned Start Date:** 2025-01-01
**Planned End Date:** 2025-01-07

### Build Prototype
**Description:** Build the prototype as per the design specifications.
**References:** https://example.com/build-doc
**Point of Contact:** Engineer B
**Effort:** 8 engineer-days
**Parallelization Factor:** 1
**Dependencies:** Prototype Design
**Planned Start Date:** 2025-01-08
**Planned End Date:** 2025-01-17
```

#### Example: Gantt Chart View

```python
gantt_chart = plan.get_gantt_chart()
print(gantt_chart)
```

**Output:**
```plantuml
@startgantt
[Prototype Design] requires 10 days
[Prototype Design] starts 2025-01-01
[Build Prototype] requires 8 days
[Build Prototype] starts 2025-01-08
@endgantt
```

---

### **6. Customizing Non-Working Days**

By default, GanttDSL skips weekends. To customize non-working days, override the `workday_filter` in the `Scheduler`.

#### Example: Customizing the Workday Filter

```python
from ganttdsl import CriticalPathScheduler

scheduler = CriticalPathScheduler()

# Define custom filter (e.g., skipping public holidays)
def custom_workday_filter(day: date) -> bool:
    # Assume January 2nd is a holiday
    holidays = {date(2025, 1, 2)}
    return day.weekday() < 5 and day not in holidays

scheduler.workday_filter = custom_workday_filter
```

---

### **7. Handling Circular Dependencies**

If tasks have circular dependencies, the scheduler will raise an exception. For example:

```python
task_c = Task(
    name="Circular Task",
    description="This task depends on itself.",
    references=[],
    point_of_contact="Engineer C",
    effort=5,
    parallelization_factor=1,
    dependencies={task_b}  # Circular dependency
)
task_b.dependencies.add(task_c)  # Adds a back-reference to create a cycle
```

This will raise:
```
ValueError: Circular dependencies detected in tasks
```

---

### **8. Full Example**

```python
from ganttdsl import Task, Team, CriticalPathScheduler
from datetime import date

# Define tasks
task_a = Task(
    name="Prototype Design",
    description="Design the prototype with detailed requirements.",
    references=["https://example.com/design-doc"],
    point_of_contact="Engineer A",
    effort=10,
    parallelization_factor=2
)

task_b = Task(
    name="Build Prototype",
    description="Build the prototype as per the design specifications.",
    references=["https://example.com/build-doc"],
    point_of_contact="Engineer B",
    effort=8,
    parallelization_factor=1,
    dependencies={task_a}
)

# Define team
team = Team(name="Engineering Team", size=3)

# Initialize scheduler
scheduler = CriticalPathScheduler()
start_date = date(2025, 1, 1)

# Schedule tasks
plan = scheduler.schedule([task_a, task_b], team, start_date)

# View plan
print(plan.get_markdown_view())
print(plan.get_gantt_chart())
```

---
